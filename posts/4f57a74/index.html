<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>压缩所有提交 - 思所匪夷</title><meta name=author content="Jason"><meta name=description content=' 想把 当前分支的所有提交 压缩成一个提交 但是分支里有一些 Merge Commit（本地和远程的合并提交） 也就是说，历史不是线性的，不能直接用普通 git rebase -i 🔑 关键点 Merge Commit 有两个父节点，如果想压缩所有提交，需要 抛弃历史，只保留当前文件状态 安全做法：创建一个全新的孤儿分支（--orphan），把当前工作区内容提交成一个 commit，然后强制推送覆盖原分支 步骤 1️⃣ 创建孤儿分支 1 git checkout --orphan temp_branch --orphan → 新建一个没有历史的分支 此时 HEAD 是新分支，没有任何提交 2️⃣ 添加当前文件 1 git add -A 把工作区里所有文件添加到暂存区 3️⃣ 创建一个提交 1 git commit -m "压缩所有提交为一个提交" 当前分支现在只有 一个提交，保留了所有内容 4️⃣ 替换原分支 1 git branch -M main 把孤儿分支重命名为 main（或你的目标分支名） 5️⃣ 强制推送到远程 1 git push origin main --force --force 会覆盖远程历史 所以远程的 merge commit 和所有旧提交都会被删除，只保留你现在的单一提交 ✅ 总结 普通 squash / rebase 不能处理 merge commit 孤儿分支 + 一次提交 + force push 是最安全的彻底压缩方法 适合博客仓库或 Pages 部署仓库，保留最新内容即可 '><meta name=keywords content='Git,Intellij IDEA'><meta itemprop=name content="压缩所有提交"><meta itemprop=description content='想把 当前分支的所有提交 压缩成一个提交 但是分支里有一些 Merge Commit（本地和远程的合并提交） 也就是说，历史不是线性的，不能直接用普通 git rebase -i 🔑 关键点 Merge Commit 有两个父节点，如果想压缩所有提交，需要 抛弃历史，只保留当前文件状态 安全做法：创建一个全新的孤儿分支（--orphan），把当前工作区内容提交成一个 commit，然后强制推送覆盖原分支 步骤 1️⃣ 创建孤儿分支 1 git checkout --orphan temp_branch --orphan → 新建一个没有历史的分支 此时 HEAD 是新分支，没有任何提交 2️⃣ 添加当前文件 1 git add -A 把工作区里所有文件添加到暂存区 3️⃣ 创建一个提交 1 git commit -m "压缩所有提交为一个提交" 当前分支现在只有 一个提交，保留了所有内容 4️⃣ 替换原分支 1 git branch -M main 把孤儿分支重命名为 main（或你的目标分支名） 5️⃣ 强制推送到远程 1 git push origin main --force --force 会覆盖远程历史 所以远程的 merge commit 和所有旧提交都会被删除，只保留你现在的单一提交 ✅ 总结 普通 squash / rebase 不能处理 merge commit 孤儿分支 + 一次提交 + force push 是最安全的彻底压缩方法 适合博客仓库或 Pages 部署仓库，保留最新内容即可'><meta itemprop=datePublished content="2025-09-05T17:18:30+08:00"><meta itemprop=dateModified content="2025-09-05T17:18:30+08:00"><meta itemprop=wordCount content="438"><meta itemprop=image content="https://actforjason.github.io/logos/%E6%96%87-48.png"><meta itemprop=keywords content="Git, Intellij IDEA"><meta property="og:url" content="https://actforjason.github.io/posts/4f57a74/"><meta property="og:site_name" content="思所匪夷"><meta property="og:title" content="压缩所有提交"><meta property="og:description" content='想把 当前分支的所有提交 压缩成一个提交 但是分支里有一些 Merge Commit（本地和远程的合并提交） 也就是说，历史不是线性的，不能直接用普通 git rebase -i 🔑 关键点 Merge Commit 有两个父节点，如果想压缩所有提交，需要 抛弃历史，只保留当前文件状态 安全做法：创建一个全新的孤儿分支（--orphan），把当前工作区内容提交成一个 commit，然后强制推送覆盖原分支 步骤 1️⃣ 创建孤儿分支 1 git checkout --orphan temp_branch --orphan → 新建一个没有历史的分支 此时 HEAD 是新分支，没有任何提交 2️⃣ 添加当前文件 1 git add -A 把工作区里所有文件添加到暂存区 3️⃣ 创建一个提交 1 git commit -m "压缩所有提交为一个提交" 当前分支现在只有 一个提交，保留了所有内容 4️⃣ 替换原分支 1 git branch -M main 把孤儿分支重命名为 main（或你的目标分支名） 5️⃣ 强制推送到远程 1 git push origin main --force --force 会覆盖远程历史 所以远程的 merge commit 和所有旧提交都会被删除，只保留你现在的单一提交 ✅ 总结 普通 squash / rebase 不能处理 merge commit 孤儿分支 + 一次提交 + force push 是最安全的彻底压缩方法 适合博客仓库或 Pages 部署仓库，保留最新内容即可'><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-09-05T17:18:30+08:00"><meta property="article:modified_time" content="2025-09-05T17:18:30+08:00"><meta property="article:tag" content="Git, Intellij IDEA"><meta property="og:image" content="https://actforjason.github.io/logos/%E6%96%87-48.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://actforjason.github.io/logos/%E6%96%87-48.png"><meta name=twitter:title content="压缩所有提交"><meta name=twitter:description content='想把 当前分支的所有提交 压缩成一个提交 但是分支里有一些 Merge Commit（本地和远程的合并提交） 也就是说，历史不是线性的，不能直接用普通 git rebase -i 🔑 关键点 Merge Commit 有两个父节点，如果想压缩所有提交，需要 抛弃历史，只保留当前文件状态 安全做法：创建一个全新的孤儿分支（--orphan），把当前工作区内容提交成一个 commit，然后强制推送覆盖原分支 步骤 1️⃣ 创建孤儿分支 1 git checkout --orphan temp_branch --orphan → 新建一个没有历史的分支 此时 HEAD 是新分支，没有任何提交 2️⃣ 添加当前文件 1 git add -A 把工作区里所有文件添加到暂存区 3️⃣ 创建一个提交 1 git commit -m "压缩所有提交为一个提交" 当前分支现在只有 一个提交，保留了所有内容 4️⃣ 替换原分支 1 git branch -M main 把孤儿分支重命名为 main（或你的目标分支名） 5️⃣ 强制推送到远程 1 git push origin main --force --force 会覆盖远程历史 所以远程的 merge commit 和所有旧提交都会被删除，只保留你现在的单一提交 ✅ 总结 普通 squash / rebase 不能处理 merge commit 孤儿分支 + 一次提交 + force push 是最安全的彻底压缩方法 适合博客仓库或 Pages 部署仓库，保留最新内容即可'><meta name=application-name content="Ponderer"><meta name=apple-mobile-web-app-title content="Ponderer"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=logos/%e6%96%87-48.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical type=text/html href=https://actforjason.github.io/posts/4f57a74/ title="压缩所有提交 - 思所匪夷"><link rel=alternate type=text/markdown href=https://actforjason.github.io/posts/4f57a74/index.md title="压缩所有提交 - 思所匪夷"><link rel=stylesheet href=/css/config.min.css><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"压缩所有提交","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/actforjason.github.io\/posts\/4f57a74\/"},"genre":"posts","keywords":"Git, Intellij IDEA","wordcount":438,"url":"https:\/\/actforjason.github.io\/posts\/4f57a74\/","datePublished":"2025-09-05T17:18:30+08:00","dateModified":"2025-09-05T17:18:30+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Jason"},"description":""}</script><script src=/js/head/color-scheme.min.js></script></head><body data-header-desktop=sticky data-header-mobile=auto><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=left><div class=header-title><a href=/ title=思所匪夷><img class=logo src=/logos/文-128.png alt=思所匪夷 height=32 width=32><span class=typeit><template>思所匪夷</template></span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 文章</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/collections/><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> 合集</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder=搜索文章标题或内容…… id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=思所匪夷><img class=logo src=logos/文-128.png alt=思所匪夷 height=26 width=26><span class=typeit><template>思所匪夷</template></span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容…… id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 文章</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/collections/><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> 合集</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=fi-container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label=合集><div class="details collection-details open"><div class="details-summary collection-summary"><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i>
<span class=collection-name title=合集>Git</span>
<span class=collection-count>1</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content collection-content"><nav><ul class=collection-list><li class=collection-item><span class=active title=压缩所有提交>压缩所有提交</span></li></ul><div class=collection-nav-simple><i class="fa-solid fa-angle-left fa-fw collection-nav-item text-secondary" aria-hidden=true></i><span class=text-secondary>1/1</span><i class="fa-solid fa-angle-right fa-fw collection-nav-item text-secondary" aria-hidden=true></i></div></nav></div></div></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>压缩所有提交</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://github.com/actforjason title=作者 target=_blank rel="external nofollow noopener noreferrer author" class=author><i class="fa-solid fa-user-circle" aria-hidden=true></i>
Jason</a></span><span class=post-included-in>&nbsp;收录于 <a href=/categories/git/ class=post-category title="分类 - Git"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> Git</a> 和 <a href=/collections/git/ class=post-collection title="合集 - Git"><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i> Git</a></span></div><div class=post-meta-line><span title="发布于 2025-09-05 17:18:30"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=2025-09-05>2025-09-05</time></span>&nbsp;<span title="438 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>约 500 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>预计阅读 1 分钟</span>&nbsp;<span class=comment-visitors data-flag-title=压缩所有提交><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span class=artalk-visitor-count data-page-key=/posts/4f57a74/>-</span>&nbsp;次阅读
</span>&nbsp;<span class=comment-count data-flag-title=压缩所有提交>
<i class="fa-regular fa-comments fa-fw me-1" aria-hidden=true></i><span class=artalk-comment-count data-page-key=/posts/4f57a74/>-</span>&nbsp;条评论
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#-关键点>🔑 关键点</a></li><li><a href=#步骤>步骤</a><ul><li><a href=#1-创建孤儿分支>1️⃣ 创建孤儿分支</a></li><li><a href=#2-添加当前文件>2️⃣ 添加当前文件</a></li><li><a href=#3-创建一个提交>3️⃣ 创建一个提交</a></li><li><a href=#4-替换原分支>4️⃣ 替换原分支</a></li><li><a href=#5-强制推送到远程>5️⃣ 强制推送到远程</a></li></ul></li><li><a href=#-总结>✅ 总结</a></li></ul></nav></div></div><div class=content id=content><ul><li>想把 <strong>当前分支的所有提交</strong> 压缩成一个提交</li><li>但是分支里有一些 <strong>Merge Commit（本地和远程的合并提交）</strong></li><li>也就是说，历史不是线性的，不能直接用普通 <code>git rebase -i</code></li></ul><hr><h2 class=heading-element id=-关键点><span>🔑 关键点</span>
<a href=#-%e5%85%b3%e9%94%ae%e7%82%b9 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><ol><li><strong>Merge Commit</strong> 有两个父节点，如果想压缩所有提交，需要 <strong>抛弃历史，只保留当前文件状态</strong></li><li><strong>安全做法</strong>：创建一个全新的孤儿分支（<code>--orphan</code>），把当前工作区内容提交成一个 commit，然后强制推送覆盖原分支</li></ol><hr><h2 class=heading-element id=步骤><span>步骤</span>
<a href=#%e6%ad%a5%e9%aa%a4 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=1-创建孤儿分支><span>1️⃣ 创建孤儿分支</span>
<a href=#1-%e5%88%9b%e5%bb%ba%e5%ad%a4%e5%84%bf%e5%88%86%e6%94%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git checkout --orphan temp_branch</span></span></code></pre></td></tr></table></div></div><ul><li><code>--orphan</code> → 新建一个没有历史的分支</li><li>此时 HEAD 是新分支，没有任何提交</li></ul><hr><h3 class=heading-element id=2-添加当前文件><span>2️⃣ 添加当前文件</span>
<a href=#2-%e6%b7%bb%e5%8a%a0%e5%bd%93%e5%89%8d%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git add -A</span></span></code></pre></td></tr></table></div></div><ul><li>把工作区里所有文件添加到暂存区</li></ul><hr><h3 class=heading-element id=3-创建一个提交><span>3️⃣ 创建一个提交</span>
<a href=#3-%e5%88%9b%e5%bb%ba%e4%b8%80%e4%b8%aa%e6%8f%90%e4%ba%a4 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git commit -m <span class=s2>&#34;压缩所有提交为一个提交&#34;</span></span></span></code></pre></td></tr></table></div></div><ul><li>当前分支现在只有 <strong>一个提交</strong>，保留了所有内容</li></ul><hr><h3 class=heading-element id=4-替换原分支><span>4️⃣ 替换原分支</span>
<a href=#4-%e6%9b%bf%e6%8d%a2%e5%8e%9f%e5%88%86%e6%94%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git branch -M main</span></span></code></pre></td></tr></table></div></div><ul><li>把孤儿分支重命名为 <code>main</code>（或你的目标分支名）</li></ul><hr><h3 class=heading-element id=5-强制推送到远程><span>5️⃣ 强制推送到远程</span>
<a href=#5-%e5%bc%ba%e5%88%b6%e6%8e%a8%e9%80%81%e5%88%b0%e8%bf%9c%e7%a8%8b class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git push origin main --force</span></span></code></pre></td></tr></table></div></div><ul><li><code>--force</code> 会覆盖远程历史</li><li>所以远程的 merge commit 和所有旧提交都会被删除，只保留你现在的单一提交</li></ul><hr><h2 class=heading-element id=-总结><span>✅ 总结</span>
<a href=#-%e6%80%bb%e7%bb%93 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><ul><li><strong>普通 squash / rebase</strong> 不能处理 merge commit</li><li><strong>孤儿分支 + 一次提交 + force push</strong> 是最安全的彻底压缩方法</li><li>适合博客仓库或 Pages 部署仓库，保留最新内容即可</li></ul><hr></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2025-09-05 17:18:30">更新于 2025-09-05&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank>CC BY-NC-SA 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/posts/4f57a74/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 X" data-sharer=twitter data-url=https://actforjason.github.io/posts/4f57a74/ data-title=压缩所有提交 data-hashtags="Git, Intellij IDEA"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://actforjason.github.io/posts/4f57a74/ data-hashtag="Git, Intellij IDEA"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://actforjason.github.io/posts/4f57a74/ data-title=压缩所有提交><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/git-intellij-idea/ class=post-tag title="标签 - Git, Intellij IDEA">Git, Intellij IDEA</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav></div></div><div id=comments><div id=artalk class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://github.com/ArtalkJS/Artalk rel="external nofollow noopener noreferrer">Artalk</a>.</noscript></div></article><aside class=toc id=toc-auto aria-label=目录><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class="toc-content always-active" id=toc-content-auto></div></aside></main><footer class=footer><div class=footer-container><div class="footer-line copyright order-1" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2025</span><span class=author itemprop=copyrightHolder>
<a href=https://github.com/actforjason target=_blank rel="external nofollow noopener noreferrer">Jason</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div><div class="footer-line statistics"><span class=site-time title=网站运行中……><i class="fa-solid fa-heartbeat fa-fw animate-icon" aria-hidden=true></i><span class="run-times ms-1">网站运行中……</span></span></div><div class="footer-line visitor"><span id=busuanzi_container_site_uv title=总访客数><i class="fa-regular fa-user fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_uv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span><span id=busuanzi_container_site_pv class=footer-divider title=总访问量><i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_site_pv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class="variant-numeric d-none">0%</span></div><div class="fixed-button view-comments d-none" role=button aria-label=查看评论><i class="fa-solid fa-comment fa-fw" aria-hidden=true></i></div></div><a href=https://github.com/actforjason title="View source on GitHub" target=_blank rel="external nofollow" class="github-corner left d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true" width="56" height="56"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><div id=mask></div><noscript><div class=noscript-warning>该网站在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/artalk@latest/dist/Artalk.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-minimal.css><script src=https://cdn.jsdelivr.net/npm/artalk@latest/dist/Artalk.js></script><script src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js defer></script><script src=https://cdn.jsdelivr.net/npm/fuse.js@6.6.2/dist/fuse.min.js defer></script><script src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js async defer></script><script src=https://cdn.jsdelivr.net/npm/typeit@8.8.4/dist/index.umd.js defer></script><script src=https://vercount.one/js async defer></script><script src=https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js async defer></script><script>window.config={code:{copyTitle:"复制到剪贴板",editLockTitle:"锁定可编辑代码块",editUnLockTitle:"解锁可编辑代码块",editable:!0,maxShownLines:10},comment:{artalk:{countEl:"artalk-comment-count",editorTravel:!0,el:"#artalk",flatMode:"auto",gravatar:{mirror:"https://www.gravatar.com/avatar/",params:"d=wavatar&s=240"},locale:"zh-CN",nestMax:2,nestSort:"DATE_ASC",pageKey:"https://actforjason.github.io/posts/4f57a74/",pageTitle:"压缩所有提交",pvEl:"artalk-visitor-count",server:"https://yourdomain",site:"默认站点",useBackendConf:!1},enable:!0,expired:!1},search:{distance:1e3,findAllMatches:!1,fuseIndexURL:"/search.json",highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!1,isCaseSensitive:!1,location:0,maxResultLength:10,minMatchCharLength:2,noResultsFound:"没有找到结果",snippetLength:30,threshold:.3,type:"fuse",useExtendedSearch:!1},siteTime:"2025-09-04T21:15:22+08:00",typeit:{cursorChar:"|",cursorSpeed:1e3,duration:-1,loop:!1,speed:100},version:"v0.4.0-alpha-20250831070510-5a66a050"}</script><script src=/js/theme.min.js defer></script></body></html>